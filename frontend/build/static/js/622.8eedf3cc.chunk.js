"use strict";(self.webpackChunkween_sports_betting=self.webpackChunkween_sports_betting||[]).push([[622],{4622:(e,s,t)=>{t.r(s),t.d(s,{default:()=>d});var a=t(9379),i=t(5043),o=t(4194),n=t(6305),r=t(2104),l=t(9456),c=t(579);const d=()=>{const[e,s]=(0,i.useState)([]),[t,d]=(0,i.useState)(!0),[h,m]=(0,i.useState)(null),[u,v]=(0,i.useState)(null),{user:p}=(0,l.d4)(e=>e.auth),g=async()=>{try{d(!0),m(null),console.log("[LIVE BETTING] Fetching live matches from API...");const e=await n.A.getLiveMatches();if(!e.data.success)throw new Error(e.data.message||"Failed to fetch live matches");{const t=e.data.matches||[];console.log("[LIVE BETTING] Received ".concat(t.length," live matches from API")),0===t.length?(console.log("[LIVE BETTING] No live matches found"),s([])):(s(t),v((new Date).toISOString()))}}catch(e){console.error("[LIVE BETTING] Error fetching live matches:",e),m("Failed to load live matches. Please try again later."),s([])}finally{d(!1)}};if((0,i.useEffect)(()=>{g(),(()=>{const e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:5000"}.REACT_APP_WS_URL||null;if(e)try{const t=(0,r.Ay)(e,{withCredentials:!0});return t.on("connect",()=>{console.log("[LIVE BETTING] Connected to Socket.IO"),t.emit("subscribe:live")}),t.on("matchUpdate",e=>{s(s=>{const t=s.findIndex(s=>(s._id||s.id)===(e._id||e.id));if(-1===t)return s;const i=[...s];return i[t]=(0,a.A)((0,a.A)({},i[t]),e),i}),v((new Date).toISOString())}),t.on("oddsUpdate",e=>{const t=(null===e||void 0===e?void 0:e.matchId)||(null===e||void 0===e?void 0:e._id)||(null===e||void 0===e?void 0:e.id),i=(null===e||void 0===e?void 0:e.delta)||(null===e||void 0===e?void 0:e.odds)||e;s(e=>e.map(e=>(e._id||e.id)!==t?e:(0,a.A)((0,a.A)({},e),{},{odds:(0,a.A)((0,a.A)({},e.odds||{}),i||{})})))}),t.on("newMatch",e=>{s(s=>{const t=e._id||e.id;return t?s.some(e=>(e._id||e.id)===t)?s:[e,...s]:s})}),t.on("matchDeleted",e=>{s(s=>s.filter(s=>(s._id||s.id)!==e))}),t.on("disconnect",()=>{console.log("[LIVE BETTING] Disconnected from Socket.IO")}),()=>t.disconnect()}catch(h){console.error("[LIVE BETTING] Error setting up Socket.IO:",h)}else console.warn("[LIVE BETTING] WS_URL not set; skipping Socket.IO")})();const e=setInterval(()=>{console.log("[LIVE BETTING] Polling for updated live matches..."),g()},3e4);return()=>{clearInterval(e)}},[p]),t)return(0,c.jsxs)("div",{className:"sport-page",children:[(0,c.jsxs)("div",{className:"sport-header",children:[(0,c.jsx)("h1",{className:"sport-title",children:"Live Betting"}),(0,c.jsx)("p",{className:"sport-subtitle",children:"Bet on live matches with real-time odds"})]}),(0,c.jsxs)("div",{className:"matches-section",children:[(0,c.jsxs)("div",{className:"section-header",children:[(0,c.jsx)("h2",{className:"section-title",children:"LIVE MATCHES"}),(0,c.jsxs)("div",{className:"live-indicator",children:[(0,c.jsx)("span",{className:"live-dot"}),(0,c.jsx)("span",{children:"Loading..."})]})]}),(0,c.jsxs)("div",{className:"loading-container",children:[(0,c.jsx)("div",{className:"loading-spinner"}),(0,c.jsx)("p",{children:"Loading live matches..."})]})]})]});const x=(e=>{const s={};return e.forEach(e=>{const t=e.league;s[t]||(s[t]=[]),s[t].push(e)}),s})(e);return(0,c.jsxs)("div",{className:"sport-page",children:[(0,c.jsxs)("div",{className:"sport-header",children:[(0,c.jsx)("h1",{className:"sport-title",children:"Live Betting"}),(0,c.jsx)("p",{className:"sport-subtitle",children:"Bet on live matches with real-time odds"})]}),(0,c.jsxs)("div",{className:"matches-section",children:[(0,c.jsxs)("div",{className:"section-header",children:[(0,c.jsx)("h2",{className:"section-title",children:"LIVE MATCHES"}),(0,c.jsxs)("div",{className:"live-indicator",children:[(0,c.jsx)("span",{className:"live-dot"}),(0,c.jsxs)("span",{children:[e.length," Live Now"]}),u&&(0,c.jsxs)("span",{className:"last-update",children:["Last updated: ",new Date(u).toLocaleTimeString()]})]})]}),h&&(0,c.jsx)("div",{className:"error-message",style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"12px",margin:"16px 0",color:"#ff6666"},children:h}),e.length>0?(0,c.jsx)("div",{className:"live-matches-container",children:Object.entries(x).map(e=>{let[s,t]=e;const a=(e=>{if(0===e.length)return[];const s=new Set;e.forEach(e=>{e.odds&&Object.keys(e.odds).forEach(t=>{e.odds[t]&&e.odds[t]>0&&s.add(t)})});const t={};return s.forEach(s=>{t[s]=e.filter(e=>e.odds&&e.odds[s]&&e.odds[s]>0).length}),Object.entries(t).sort((e,s)=>{let[,t]=e,[,a]=s;return a-t}).slice(0,3).map(e=>{let[s]=e;return s})})(t);return(0,c.jsxs)("div",{className:"league-group",children:[(0,c.jsxs)("div",{className:"league-header live-league-header",children:[(0,c.jsxs)("div",{className:"league-title",children:[(0,c.jsx)("span",{className:"arrow",children:"\u25b2"}),(()=>{const e=t&&t[0]?t[0]:{},a=e.sport||e.sport_title,i=e.subcategory||e.country,o=e=>(e||"").toString().trim().replace(/[.\xb7]+$/,""),n=[o(a),o(i),o(s)].filter(Boolean),r=n.filter((e,s)=>1!==s||!n[2]||!n[2].toLowerCase().includes(e.toLowerCase()));return Array.from(new Set(r.map(e=>e.toLowerCase()))).map(e=>r.find(s=>s.toLowerCase()===e)).join(" \xb7 ")})()]}),a.map(e=>(0,c.jsx)("div",{className:"odds-header live-odds-header",children:e},e))]}),(0,c.jsx)("div",{className:"league-matches",children:t.map(e=>(0,c.jsx)(o.A,{match:e,sport:e.sport,league:e.league,subcategory:e.subcategory,showLeagueHeader:!1,showOddsHeaders:!1},e.id))})]},s)})}):(0,c.jsxs)("div",{className:"no-live-matches",children:[(0,c.jsx)("div",{className:"no-live-icon",children:"\ud83d\udd34"}),(0,c.jsx)("h3",{children:"No Live Matches"}),(0,c.jsx)("p",{children:"There are currently no live matches. Check back later for live betting opportunities."}),(0,c.jsxs)("div",{className:"live-refresh-info",children:[(0,c.jsx)("p",{children:"Live matches are automatically refreshed every 30 seconds."}),(0,c.jsx)("button",{className:"refresh-btn",onClick:g,style:{background:"#ff4444",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",marginTop:"12px"},children:"Refresh Now"})]})]})]})]})}}}]);
//# sourceMappingURL=622.8eedf3cc.chunk.js.map