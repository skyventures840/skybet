"use strict";(self.webpackChunkween_sports_betting=self.webpackChunkween_sports_betting||[]).push([[903],{7903:(e,s,t)=>{t.r(s),t.d(s,{default:()=>o});var a=t(9379),l=t(5043),n=t(6305),i=t(579);const o=()=>{var e;const[s,t]=(0,l.useState)([]),[o,c]=(0,l.useState)(!0),[r,d]=(0,l.useState)(null),[m,u]=(0,l.useState)(new Set),[h,p]=(0,l.useState)({activeBets:0,totalBets:0,winRate:0,wonBets:0,lostBets:0,voidBets:0,cancelledBets:0}),[v,x]=(0,l.useState)({status:"all",type:"all"}),[j,g]=(0,l.useState)(null),[N,b]=(0,l.useState)(!1);(0,l.useEffect)(()=>{y(),f()},[]),(0,l.useEffect)(()=>{if(s.length>0){f();const e=w(s);p(s=>(0,a.A)((0,a.A)({},s),e))}},[s]),(0,l.useEffect)(()=>{const e=()=>{y(),f()};return window.addEventListener("bet:update",e),()=>window.removeEventListener("bet:update",e)},[]);const y=async()=>{try{c(!0),d(null),console.log("Fetching bet history...");const e=await n.A.getUserBets();if(console.log("Bet history API response:",e),e&&e.data){console.log("Bet history data:",e.data);const s=e.data.bets||[];t(s)}else console.log("No response data received"),t([])}catch(a){var e,s;console.error("Failed to fetch bet history:",a),console.error("Error details:",{message:a.message,response:null===(e=a.response)||void 0===e?void 0:e.data,status:null===(s=a.response)||void 0===s?void 0:s.status}),d("Failed to load bet history."),t([])}finally{c(!1)}},w=e=>{const s=e.length,t=e.filter(e=>"pending"===(e.status||"pending").toLowerCase()).length,a=e.filter(e=>"won"===(e.status||"").toLowerCase()).length,l=e.filter(e=>"lost"===(e.status||"").toLowerCase()).length,n=e.filter(e=>"void"===(e.status||"").toLowerCase()).length,i=e.filter(e=>"cancelled"===(e.status||"").toLowerCase()).length,o=a+l,c=o>0?(a/o*100).toFixed(1):0;return{totalBets:s,activeBets:t,wonBets:a,lostBets:l,voidBets:n,cancelledBets:i,winRate:parseFloat(c)}},f=async()=>{try{console.log("Fetching bet stats summary from database...");const u=await n.A.getBetStatsSummary();if(console.log("Bet stats API response:",u),u&&u.data){var e,t,a,l,i,o,c,r,d,m;const s=u.data;console.log("Processing bet stats summary:",s);const n={activeBets:null!==(e=null!==(t=s.activeBets)&&void 0!==t?t:s.pendingBets)&&void 0!==e?e:0,totalBets:null!==(a=s.totalBets)&&void 0!==a?a:0,winRate:null!=s.winRate?parseFloat(s.winRate):0,wonBets:null!==(l=s.wonBets)&&void 0!==l?l:0,lostBets:null!==(i=s.lostBets)&&void 0!==i?i:0,voidBets:null!==(o=s.voidBets)&&void 0!==o?o:0,cancelledBets:null!==(c=s.cancelledBets)&&void 0!==c?c:0,totalStaked:null!==(r=s.totalStaked)&&void 0!==r?r:0,totalWon:null!==(d=s.totalWon)&&void 0!==d?d:0,profit:null!==(m=s.profit)&&void 0!==m?m:0};console.log("Setting stats from database:",n),p(n)}else{console.warn("No data received from bet stats API, using local calculation");const e=w(s);p(e)}}catch(v){var u,h;console.error("Failed to fetch bet stats summary:",v),console.error("Error details:",{message:v.message,response:null===(u=v.response)||void 0===u?void 0:u.data,status:null===(h=v.response)||void 0===h?void 0:h.status}),console.log("Using local calculation as fallback");const e=w(s);p(e)}},B=e=>{m.has(e)?u(new Set):u(new Set([e]))},S=e=>{g(e),b(!0)},T=e=>"number"===typeof e?e.toFixed(2):e&&"number"===typeof e.selected?e.selected.toFixed(2):e&&"string"===typeof e?parseFloat(e).toFixed(2):"0.00",k=e=>"number"===typeof e?e.toFixed(2):e&&"string"===typeof e?parseFloat(e).toFixed(2):"0.00",A=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),C=(e,s)=>{x(t=>(0,a.A)((0,a.A)({},t),{},{[e]:s}))};return(0,i.jsxs)("div",{className:"bets-page",children:[(0,i.jsxs)("div",{className:"bets-header",children:[(0,i.jsx)("h1",{children:"My Bets"}),(0,i.jsxs)("div",{className:"bets-stats",children:[(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("span",{className:"stat-label",children:"Active Bets"}),(0,i.jsx)("span",{className:"stat-value",children:h.activeBets})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("span",{className:"stat-label",children:"Total Bets"}),(0,i.jsx)("span",{className:"stat-value",children:h.totalBets})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("span",{className:"stat-label",children:"Win Rate"}),(0,i.jsxs)("span",{className:"stat-value",children:[h.winRate,"%"]})]})]})]}),(0,i.jsx)("div",{className:"bets-content",children:o?(0,i.jsxs)("div",{className:"loading-container",children:[(0,i.jsx)("div",{className:"loading-spinner"}),(0,i.jsx)("p",{children:"Loading bet history..."})]}):r?(0,i.jsxs)("div",{className:"error-container",children:[(0,i.jsx)("p",{className:"error-message",children:r}),(0,i.jsx)("button",{onClick:y,className:"retry-btn",children:"Retry"})]}):0===s.length?(0,i.jsxs)("div",{className:"no-bets",children:[(0,i.jsx)("div",{className:"no-bets-icon",children:"\ud83c\udfaf"}),(0,i.jsx)("h3",{children:"No bets placed yet"}),(0,i.jsx)("p",{children:"Start betting on your favorite sports to see your bet history here."})]}):(0,i.jsxs)("div",{className:"bet-history-container",children:[(0,i.jsxs)("div",{className:"bet-history-header",children:[(0,i.jsxs)("div",{className:"bet-history-title-section",children:[(0,i.jsx)("h2",{children:"Bet History"}),(0,i.jsxs)("div",{className:"bet-history-stats",children:[(0,i.jsxs)("span",{className:"stat-item",children:["Total: ",h.totalBets]}),(0,i.jsxs)("span",{className:"stat-item",children:["Pending: ",h.activeBets]}),(0,i.jsxs)("span",{className:"stat-item",children:["Won: ",h.wonBets]}),(0,i.jsxs)("span",{className:"stat-item",children:["Lost: ",h.lostBets]})]})]}),(0,i.jsxs)("div",{className:"bet-filters",children:[(0,i.jsxs)("div",{className:"filter-group",children:[(0,i.jsx)("label",{children:"Status:"}),(0,i.jsxs)("select",{value:v.status,onChange:e=>C("status",e.target.value),className:"filter-select",children:[(0,i.jsx)("option",{value:"all",children:"All"}),(0,i.jsx)("option",{value:"pending",children:"Pending"}),(0,i.jsx)("option",{value:"won",children:"Won"}),(0,i.jsx)("option",{value:"lost",children:"Lost"}),(0,i.jsx)("option",{value:"void",children:"Void"})]})]}),(0,i.jsxs)("div",{className:"filter-group",children:[(0,i.jsx)("label",{children:"Type:"}),(0,i.jsxs)("select",{value:v.type,onChange:e=>C("type",e.target.value),className:"filter-select",children:[(0,i.jsx)("option",{value:"all",children:"All"}),(0,i.jsx)("option",{value:"single",children:"Single"}),(0,i.jsx)("option",{value:"parlay",children:"Multibet"})]})]})]})]}),(0,i.jsx)("div",{className:"bet-history-list",children:s.filter(e=>{if("all"!==v.status){const s=(e.status||"pending").toLowerCase();if(v.status!==s)return!1}if("all"!==v.type){const s="parlay"===e.market&&e.matches&&e.matches.length>1;if("parlay"===v.type&&!s)return!1;if("single"===v.type&&s)return!1}return!0}).map(e=>{var s;const t=m.has(e.id),l="parlay"===e.market&&e.matches&&e.matches.length>1;let n=e.matches||[];const o=e=>{if(!e)return"pending";const s=String(e).toLowerCase();return"win"===s?"won":"loss"===s?"lost":s};if(l&&0===n.length&&e.selection&&e.selection.includes(";")){n=e.selection.split(";").map((e,s)=>{const t=e.split(":");if(t.length>=2){const e=t[0].trim(),a=t[1].trim().match(/(.+?)\s*\(([0-9.]+)\)/);return{matchId:"legacy-".concat(s),homeTeam:e.split(" vs ")[0]||"Unknown",awayTeam:e.split(" vs ")[1]||"Unknown",selection:a?a[1].trim():"1",odds:a?parseFloat(a[2]):1.5,status:0===s||1===s?"won":"pending",outcome:0===s?"1":1===s?"2":null,startTime:new Date}}return null}).filter(Boolean)}var c,r,d,u;l||0!==n.length||(n=[{matchId:e.matchId,homeTeam:(null===(c=e.match)||void 0===c?void 0:c.homeTeam)||"Unknown",awayTeam:(null===(r=e.match)||void 0===r?void 0:r.awayTeam)||"Unknown",selection:e.selection,odds:(null===(d=e.odds)||void 0===d?void 0:d.selected)||e.odds,status:e.status,outcome:(null===(u=e.result)||void 0===u?void 0:u.outcome)||e.status,startTime:e.createdAt}]);n=n.map(e=>{var s;return(0,a.A)((0,a.A)({},e),{},{status:o(e.status),outcome:e.outcome||(null===(s=e.result)||void 0===s?void 0:s.finalOutcome)||null})});const h=n.filter(e=>"won"===o(e.status)).length,p=n.filter(e=>"lost"===o(e.status)).length,v=n.length||1,x=e=>{if(e.result&&(null!=e.result.homeScore||null!=e.result.awayScore)){var s,t;const a=null!==(s=e.result.homeScore)&&void 0!==s?s:"-",l=null!==(t=e.result.awayScore)&&void 0!==t?t:"-";return"".concat(a,"-").concat(l)}return e.finalScore?e.finalScore:e.outcome&&["1","X","2"].includes(String(e.outcome))?e.outcome:"pending"===o(e.status)?"\u2014":e.outcome||e.status||"\u2014"};return(0,i.jsxs)("div",{className:"bet-card ".concat(e.status," ").concat(t?"expanded":"collapsed"),children:[!t&&(0,i.jsxs)("div",{className:"bet-summary-collapsed",onClick:()=>S(e),style:{cursor:"pointer"},children:[(0,i.jsx)("div",{className:"bet-summary-info",children:(0,i.jsxs)("div",{className:"bet-summary-title",children:["#",(null===(s=e.id)||void 0===s?void 0:s.slice(-6))||"N/A"," \u2022 ",A(e.createdAt)]})}),(0,i.jsxs)("div",{className:"bet-summary-amounts",children:[(0,i.jsxs)("span",{className:"bet-summary-payout",children:["$",k(e.potentialWin)]}),(0,i.jsx)("span",{className:"bet-status status-".concat((e.status||"pending").toLowerCase()),children:(()=>{const s=(e.status||"pending").toLowerCase();return"won"===s?"Won":"lost"===s?"Lost":"void"===s?"Void":"Pending"})()}),(0,i.jsx)("button",{className:"expand-btn",onClick:s=>{s.stopPropagation(),B(e.id)},title:"Expand/Collapse bet details",children:"\u25bc"})]})]}),t&&(0,i.jsxs)("div",{className:"betslip-match-details",onClick:()=>S(e),style:{cursor:"pointer"},children:[(0,i.jsxs)("div",{className:"betslip-header-expanded",children:[(0,i.jsxs)("div",{className:"betslip-header-item",children:[(0,i.jsx)("span",{className:"betslip-header-label",children:"Amount"}),(0,i.jsxs)("span",{className:"betslip-header-value",children:["$",k(e.stake)]})]}),(0,i.jsxs)("div",{className:"betslip-header-item",children:[(0,i.jsx)("span",{className:"betslip-header-label",children:"Possible Payout"}),(0,i.jsxs)("span",{className:"betslip-header-value",children:["$",k(e.potentialWin)]})]}),(0,i.jsxs)("div",{className:"betslip-header-item",children:[(0,i.jsx)("span",{className:"betslip-header-label",children:"Won/Lost/Total"}),(0,i.jsxs)("span",{className:"betslip-header-value won-lost",children:[h,"/",p,"/",v]})]}),(0,i.jsx)("button",{className:"collapse-btn",onClick:s=>{s.stopPropagation(),B(e.id)},title:"Collapse bet details",children:"\u25b2"})]}),(0,i.jsxs)("table",{className:"betslip-match-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Match"}),(0,i.jsx)("th",{children:"Pick"}),(0,i.jsx)("th",{children:"FT Results"}),(0,i.jsx)("th",{children:"Outcome"})]})}),(0,i.jsx)("tbody",{children:n.map((e,s)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"match-name",children:(0,i.jsxs)("div",{className:"match-name-stack",children:[(0,i.jsx)("span",{className:"home-team",children:e.homeTeam}),(0,i.jsx)("span",{className:"vs",children:"vs"}),(0,i.jsx)("span",{className:"away-team",children:e.awayTeam})]})}),(0,i.jsx)("td",{className:"selection",children:e.homeTeam&&e.awayTeam?(0,i.jsxs)(i.Fragment,{children:[e.selection," (",T(e.odds),")"]}):e.selection}),(0,i.jsx)("td",{className:"odds",children:x(e)}),(0,i.jsx)("td",{className:"result ".concat("lost"===o(e.status)?"lost":""),children:"won"===o(e.status)?"Won":"lost"===o(e.status)?"Lost":"void"===o(e.status)?"Void":"Pending"})]},s))})]})]})]},e.id)})})]})}),N&&j&&(0,i.jsx)("div",{className:"full-page-bet-overlay",children:(0,i.jsxs)("div",{className:"full-page-bet-container",children:[(0,i.jsxs)("div",{className:"full-page-bet-header",children:[(0,i.jsxs)("h2",{children:["Bet Details - #",(null===(e=j.id)||void 0===e?void 0:e.slice(-6))||"N/A"]}),(0,i.jsx)("button",{className:"close-full-page-btn",onClick:()=>{g(null),b(!1)},title:"Close full page view",children:"\u2715"})]}),(0,i.jsx)("div",{className:"full-page-bet-content",children:(e=>{const s=j,t="parlay"===s.market&&s.matches&&s.matches.length>1;let l=s.matches||[];const n=e=>{if(!e)return"pending";const s=String(e).toLowerCase();return"win"===s?"won":"loss"===s?"lost":s};if(t&&0===l.length&&s.selection&&s.selection.includes(";")){l=s.selection.split(";").map((e,s)=>{const t=e.split(":");if(t.length>=2){const e=t[0].trim(),a=t[1].trim().match(/(.+?)\s*\(([0-9.]+)\)/);return{matchId:"legacy-".concat(s),homeTeam:e.split(" vs ")[0]||"Unknown",awayTeam:e.split(" vs ")[1]||"Unknown",selection:a?a[1].trim():"1",odds:a?parseFloat(a[2]):1.5,status:0===s||1===s?"won":"pending",outcome:0===s?"1":1===s?"2":null,startTime:new Date}}return null}).filter(Boolean)}var o,c,r,d;t||0!==l.length||(l=[{matchId:s.matchId,homeTeam:(null===(o=s.match)||void 0===o?void 0:o.homeTeam)||"Unknown",awayTeam:(null===(c=s.match)||void 0===c?void 0:c.awayTeam)||"Unknown",selection:s.selection,odds:(null===(r=s.odds)||void 0===r?void 0:r.selected)||s.odds,status:s.status,outcome:(null===(d=s.result)||void 0===d?void 0:d.outcome)||s.status,startTime:s.createdAt}]);l=l.map(e=>{var s;return(0,a.A)((0,a.A)({},e),{},{status:n(e.status),outcome:e.outcome||(null===(s=e.result)||void 0===s?void 0:s.finalOutcome)||null})});const m=l.filter(e=>"won"===n(e.status)).length,u=l.filter(e=>"lost"===n(e.status)).length,h=l.length||1,p=e=>{if(e.result&&(null!=e.result.homeScore||null!=e.result.awayScore)){var s,t;const a=null!==(s=e.result.homeScore)&&void 0!==s?s:"-",l=null!==(t=e.result.awayScore)&&void 0!==t?t:"-";return"".concat(a,"-").concat(l)}return e.finalScore?e.finalScore:e.outcome&&["1","X","2"].includes(String(e.outcome))?e.outcome:"pending"===n(e.status)?"\u2014":e.outcome||e.status||"\u2014"};return(0,i.jsxs)("div",{className:"full-page-bet-details",children:[(0,i.jsxs)("div",{className:"full-page-bet-summary",children:[(0,i.jsxs)("div",{className:"bet-summary-item",children:[(0,i.jsx)("span",{className:"label",children:"Bet ID:"}),(0,i.jsxs)("span",{className:"value",children:["#",(null===(e=s.id)||void 0===e?void 0:e.slice(-6))||"N/A"]})]}),(0,i.jsxs)("div",{className:"bet-summary-item",children:[(0,i.jsx)("span",{className:"label",children:"Date:"}),(0,i.jsx)("span",{className:"value",children:A(s.createdAt)})]}),(0,i.jsxs)("div",{className:"bet-summary-item",children:[(0,i.jsx)("span",{className:"label",children:"Amount:"}),(0,i.jsxs)("span",{className:"value",children:["$",k(s.stake)]})]}),(0,i.jsxs)("div",{className:"bet-summary-item",children:[(0,i.jsx)("span",{className:"label",children:"Possible Payout:"}),(0,i.jsxs)("span",{className:"value",children:["$",k(s.potentialWin)]})]}),(0,i.jsxs)("div",{className:"bet-summary-item",children:[(0,i.jsx)("span",{className:"label",children:"Status:"}),(0,i.jsx)("span",{className:"value status-".concat((s.status||"pending").toLowerCase()),children:(()=>{const e=(s.status||"pending").toLowerCase();return"won"===e?"Won":"lost"===e?"Lost":"void"===e?"Void":"Pending"})()})]}),(0,i.jsxs)("div",{className:"bet-summary-item",children:[(0,i.jsx)("span",{className:"label",children:"Won/Lost/Total:"}),(0,i.jsxs)("span",{className:"value",children:[m,"/",u,"/",h]})]})]}),(0,i.jsxs)("div",{className:"full-page-matches",children:[(0,i.jsx)("h3",{children:"Match Details"}),(0,i.jsxs)("table",{className:"full-page-match-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Match"}),(0,i.jsx)("th",{children:"Pick"}),(0,i.jsx)("th",{children:"FT Results"}),(0,i.jsx)("th",{children:"Outcome"})]})}),(0,i.jsx)("tbody",{children:l.map((e,s)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"match-name",children:(0,i.jsxs)("div",{className:"match-name-stack",children:[(0,i.jsx)("span",{className:"home-team",children:e.homeTeam}),(0,i.jsx)("span",{className:"vs",children:"vs"}),(0,i.jsx)("span",{className:"away-team",children:e.awayTeam})]})}),(0,i.jsx)("td",{className:"selection",children:e.homeTeam&&e.awayTeam?(0,i.jsxs)(i.Fragment,{children:[e.selection," (",T(e.odds),")"]}):e.selection}),(0,i.jsx)("td",{className:"odds",children:p(e)}),(0,i.jsx)("td",{className:"result ".concat("lost"===n(e.status)?"lost":""),children:"won"===n(e.status)?"Won":"lost"===n(e.status)?"Lost":"void"===n(e.status)?"Void":"Pending"})]},s))})]})]})]})})()})]})})]})}}}]);
//# sourceMappingURL=903.46775526.chunk.js.map